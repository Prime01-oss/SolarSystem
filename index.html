<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-g">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Samar's Planetarium</title>
    
    <link rel="icon" type="image/png" href="favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="home-style.css"> 
</head>
<body>

    <!-- 
      NEW: "WORLD-CLASS" IMMERSIVE LOADER
    -->
    <div id="loading-screen">
        <!-- The "Warp Speed" Canvas -->
        <canvas id="loader-canvas"></canvas>
        
        <!-- The center content -->
        <div class="loader-content">
            
            <!-- The new, perfectly round logo container -->
            <div class="loader-logo-container">
                <img src="assets/images/logo-animation.gif" alt="Booting..." class="loader-logo">
            </div>
            
            <!-- The new, premium, two-line text display -->
            <h2 id="loader-greeting"></h2>
            <p id="loader-text"></p>

        </div>
    </div>
    <!-- End Loader -->


    <!-- 
      Your existing homepage.
      Starts hidden and is "un-paused" by the loader.
    -->
    <main class="home-container">
        
        <img src="assets/images/logo-animation.gif" alt="Animated Solar System" class="animated-logo">

        <h1 class="main-title main-title-home">Samar's Planetarium</h1>
        <p class="subtitle">An interactive 3D simulation of our cosmic neighborhood.</p>

        <nav class="nav-grid">
            <a href="simulation.html" class="nav-card">
                <div class="card-icon">ü™ê</div>
                <h2 data-original-text="Explore Solar System">Explore Solar System</h2>
                <p>Load the interactive 3D simulation. Fly between planets and view detailed info.</p>
            </a>

            <a href="missions.html" class="nav-card">
                <div class="card-icon"><img src="favicon.png" alt="Rocket"></div>
                <h2 data-original-text="Famous Missions">Famous Missions</h2>
                <p>Learn about humanity's greatest achievements, from the Voyager probes to the James Webb telescope.</p>
            </a>

            <a href="history.html" class="nav-card">
                <div class="card-icon">üåå</div>
                <h2 data-original-text="The History">The History</h2>
                <p>A brief story of cosmic evolution, from the Big Bang to the formation of our solar system.</p>
            </a>
        </nav>
    </main>

    <!-- 
      NEW: COMBINED JAVASCRIPT
      (Loader Logic + Homepage Animation Logic)
    -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- 1. WORLD-CLASS LOADER LOGIC ---
            
            const loadingScreen = document.getElementById('loading-screen');
            const homeContainer = document.querySelector('.home-container');
            const loaderGreeting = document.getElementById('loader-greeting');
            const loaderText = document.getElementById('loader-text');
            const canvas = document.getElementById('loader-canvas');
            const ctx = canvas.getContext('2d');

            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            // A helper function for delays
            const sleep = (ms) => new Promise(resolve => setTimeout(resolve, ms));

            // Premium Typewriter Function
            async function type(element, text, delay = 60) {
                element.innerHTML = ''; // Clear element
                element.classList.add('typing'); // Add caret
                for (let i = 0; i < text.length; i++) {
                    await sleep(delay);
                    element.innerHTML = text.substring(0, i + 1);
                }
                element.classList.remove('typing'); // Remove caret
            }

            // --- Starfield Animation ---
            let stars = [];
            const numStars = 500;
            let warpSpeed = 5; // Start at a slower speed
            let animationFrameId_Loader;

            function createStar() {
                return {
                    x: (Math.random() - 0.5) * canvas.width * 0.8,
                    y: (Math.random() - 0.5) * canvas.height * 0.8,
                    z: Math.random() * 1000
                };
            }
            for (let i = 0; i < numStars; i++) { stars[i] = createStar(); }

            function drawStarfield() {
                ctx.fillStyle = 'rgba(0, 0, 0, 0.05)'; // Trail effect
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.save();
                ctx.translate(canvas.width / 2, canvas.height / 2);

                for (let i = 0; i < numStars; i++) {
                    let star = stars[i];
                    star.z -= warpSpeed; // Move star
                    if (star.z <= 0) {
                        stars[i] = createStar();
                        star = stars[i];
                    }
                    const k = 128 / star.z;
                    const px = star.x * k;
                    const py = star.y * k;
                    const size = (1 - star.z / 1000) * 4;
                    
                    // Make stars whiter as speed increases
                    const alpha = Math.min(0.8, (1 - star.z / 1000) * (warpSpeed / 8));
                    ctx.fillStyle = `rgba(255, 255, 255, ${alpha})`;
                    ctx.beginPath();
                    ctx.arc(px, py, size, 0, Math.PI * 2);
                    ctx.fill();
                }
                ctx.restore();
                animationFrameId_Loader = requestAnimationFrame(drawStarfield);
            }

            // --- Main "Immersive Boot" Function ---
            async function startBootSequence() {
                drawStarfield(); // Start the starfield loop

                await sleep(500);
                await type(loaderGreeting, "Welcome Aboard, Traveler.", 70);
                await sleep(1000);

                await type(loaderText, "Calibrating Nav-Com...", 40);
                await sleep(1000);
                
                await type(loaderText, "Engaging Warp Drive...", 50);
                warpSpeed = 25; // <<< THE "WOAH" MOMENT
                await sleep(1500);
                
                await type(loaderGreeting, "Seat tightly.", 70);
                await sleep(500);
                await type(loaderText, "Get ready to land in the Planetarium.", 40);
                await sleep(2000);
                
                // 1. Hide the loading screen
                loadingScreen.classList.add('hidden');
                
                // 2. Show the homepage
                homeContainer.classList.add('visible');
                
                // 3. Stop the loader animation loop to save CPU
                cancelAnimationFrame(animationFrameId_Loader);
            }
            
            // Start the entire experience
            startBootSequence();


            // --- 2. HOMEPAGE ANIMATION LOGIC (Unchanged) ---
            
            // --- Letter Animation Logic ---
            const title = document.querySelector('.main-title');
            if (title) {
                const text = title.textContent;
                const staggerDelay = 0.03;
                const newHTML = text.split('').map((letter, index) => {
                    let char = (letter === ' ') ? '&nbsp;' : letter;
                    return `<span class="letter" style="transition-delay: ${index * staggerDelay}s">${char}</span>`;
                }).join('');
                title.innerHTML = newHTML;
            }

            // --- "NO-JITTER" SCRAMBLER CLASS ---
            class PremiumScrambler {
                constructor(element) {
                    this.el = element;
                    this.originalText = element.dataset.originalText;
                    this.chars = '_<>$*#';
                    this.animationId = null;
                    this.lastUpdateTime = 0;
                    this.charArray = this.originalText.split('');
                    this.revealProgress = 0;
                    this.revealSpeed = 400; 
                    this.jumbleSpeed = 50; 
                    this.lastJumbleTime = 0;
                }
                animate(currentTime) {
                    if (!this.animationId) return; 
                    const deltaTime = currentTime - this.lastUpdateTime;
                    this.revealProgress += deltaTime;
                    const jumbleDelta = currentTime - this.lastJumbleTime;
                    let needsJumble = false;
                    if (jumbleDelta > this.jumbleSpeed) {
                        needsJumble = true;
                        this.lastJumbleTime = currentTime;
                    }
                    const revealedCount = Math.floor((this.revealProgress / this.revealSpeed) * this.originalText.length);
                    for (let i = 0; i < this.originalText.length; i++) {
                        if (i < revealedCount) {
                            this.charArray[i] = this.originalText[i];
                        } 
                        else {
                            if (needsJumble) {
                                if (this.originalText[i] === ' ') {
                                    this.charArray[i] = ' ';
                                } else {
                                    this.charArray[i] = this.chars[Math.floor(Math.random() * this.chars.length)];
                                }
                            }
                        }
                    }
                    this.el.textContent = this.charArray.join('');
                    if (revealedCount >= this.originalText.length) {
                        this.stop(); 
                    } else {
                        this.lastUpdateTime = currentTime;
                        this.animationId = requestAnimationFrame((t) => this.animate(t));
                    }
                }
                start() {
                    this.revealProgress = 0;
                    this.lastUpdateTime = performance.now();
                    this.lastJumbleTime = performance.now();
                    this.charArray = this.originalText.split('').map((char) => 
                        char === ' ' ? ' ' : this.chars[Math.floor(Math.random() * this.chars.length)]
                    );
                    if (this.animationId) {
                        cancelAnimationFrame(this.animationId);
                    }
                    this.animationId = requestAnimationFrame((t) => this.animate(t));
                }
                stop() {
                    if (this.animationId) {
                        cancelAnimationFrame(this.animationId);
                    }
                    this.animationId = null;
                    this.el.textContent = this.originalText;
                }
            }
            
            const cards = document.querySelectorAll('.nav-card');
            cards.forEach(card => {
                const titleElement = card.querySelector('h2');
                const scrambler = new PremiumScrambler(titleElement);
                card.addEventListener('mouseenter', () => scrambler.start());
                card.addEventListener('mouseleave', () => scrambler.stop());
            });
        });
    </script>
</body>
</html>